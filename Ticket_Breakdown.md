# Ticket Breakdown
We are a staffing company whose primary purpose is to book Agents at Shifts posted by Facilities on our platform. We're working on a new feature which will generate reports for our client Facilities containing info on how many hours each Agent worked in a given quarter by summing up every Shift they worked. Currently, this is how the process works:

- Data is saved in the database in the Facilities, Agents, and Shifts tables
- A function `getShiftsByFacility` is called with the Facility's id, returning all Shifts worked that quarter, including some metadata about the Agent assigned to each
- A function `generateReport` is then called with the list of Shifts. It converts them into a PDF which can be submitted by the Facility for compliance.

## You've been asked to work on a ticket. It reads:

**Currently, the id of each Agent on the reports we generate is their internal database id. We'd like to add the ability for Facilities to save their own custom ids for each Agent they work with and use that id when generating reports for them.**


Based on the information given, break this ticket down into 2-5 individual tickets to perform. Provide as much detail for each ticket as you can, including acceptance criteria, time/effort estimates, and implementation details. Feel free to make informed guesses about any unknown details - you can't guess "wrong".


You will be graded on the level of detail in each ticket, the clarity of the execution plan within and between tickets, and the intelligibility of your language. You don't need to be a native English speaker, but please proof-read your work.

## Your Breakdown Here

## Ticket 1: Add Custom Agent ID field to the Agent model and update the database

### Description
Update the Agent model to include a new field for custom agent ID. The custom agent ID should be an optional field that the Facility can provide for each agent, which will be used instead of our internal database ID when generating reports.

### Acceptance Criteria
- A new field called `custom_agent_id` is added to the Agent model.
- The `custom_agent_id` field is optional: agents can have no custom_agent_id and existing agents won't be affected.
- The database is updated to support this change.

### Time/effort estimate
4-6 hours

### Implementation Details
1. Update the Agent model to include a new optional field `custom_agent_id`.
2. Alter the database schema to include the new `custom_agent_id` field in the Agents table.
3. Apply the migrations to update the database schema.

---

## Ticket 2: Modify the function getShiftsByFacility to include Custom Agent ID

### Description
Modify the function `getShiftsByFacility` so that it returns the Custom Agent ID along with the existing metadata and shift data.

### Acceptance Criteria
- The `getShiftsByFacility` function returns Agent information with Custom Agent ID if available.
- Existing code should continue to work with the updated function without any issues.

### Time/effort estimate
2-4 hours

### Implementation Details
1. Modify the `getShiftsByFacility` function to include custom agent ID in the agent metadata.
2. Ensure that the custom agent ID is returned only when it is present, otherwise return the internal agent ID.

---

## Ticket 3: Update the generateReport function to use Custom Agent ID

### Description
Update the `generateReport` function to use Custom Agent ID (when available) instead of the internal database ID when generating the PDF report for agents.

### Acceptance Criteria
- The PDF report generated by `generateReport` function should display Custom Agent ID instead of the default internal database ID, when available.
- If the Custom Agent ID is not provided, the generated PDF report should display the internal agent ID.
- No changes should be required in other parts of the code that call `generateReport`.

### Time/effort estimate
2-4 hours

### Implementation Details
1. Update the `generateReport` function to include Custom Agent ID in the agent metadata used in the report.
2. Modify the report generation logic to prioritize the Custom Agent ID over the internal agent ID when generating the report.
3. Ensure the report generation still works as expected when Custom Agent ID is not available.

---

## Ticket 4: Allow Facilities to add/update Custom Agent IDs

### Description
Update the user interface (UI) and the API endpoints to allow Facilities to add and update Custom Agent IDs for their Agents.

### Acceptance Criteria
- Facility users can add Custom Agent IDs when adding a new agent through the UI.
- Facility users can update Custom Agent IDs for existing agents through the UI.
- API endpoints for agent creation and updates are updated to handle Custom Agent IDs.

### Time/effort estimate
6-8 hours

### Implementation Details
1. Update the Agent creation and edit forms in the UI to include a new input field for Custom Agent ID.
2. Ensure the input field validation accounts for Custom Agent ID rules (unique or nullable).
3. Update the API endpoints for agent creation and updates to accept Custom Agent ID.
4. Modify the frontend code to send Custom Agent ID data to the API when creating or updating agents.